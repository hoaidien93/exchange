exports.ids=[15],exports.modules={ctCr:function(e,t,a){"use strict";var n=a("h0/l"),r=a.n(n),o=a("q1tI"),c=a.n(o),i=a("24R3");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function f(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,m(t).apply(this,arguments))}var a,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return c.a.createElement(r.a,u({title:c.a.createElement(i.a,{defaultMessage:"Are you sure?",id:"common.popconfirm_title"}),cancelText:c.a.createElement(i.a,{defaultMessage:"No",id:"common.no"}),okText:c.a.createElement(i.a,{defaultMessage:"Yes",id:"common.yes"})},this.props))}}])&&f(a.prototype,n),o&&f(a,o),t}(o.Component);t.a=h},hyda:function(e,t,a){"use strict";a.r(t);var n=a("Btem"),r=a.n(n),o=a("q1tI"),c=a.n(o),i=a("iNPk"),s=a("/MKj"),l=a("EC67"),u=a("vVgw"),f=a("4IMT"),p=a.n(f),m=a("24R3");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e){return(h="function"==typeof Symbol&&"symbol"===d(Symbol.iterator)?function(e){return d(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":d(e)})(e)}function b(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,g(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props.onToggleDrawer;return c.a.createElement("div",{className:"cp-comment-box"},c.a.createElement("div",{className:"cp-fs-80"},c.a.createElement("i",{className:"la la-comments"})),c.a.createElement("h1",{className:"text-muted"},c.a.createElement(m.a,{defaultMessage:"Select Chat to Begin!",id:"chat.select_to_begin"})),c.a.createElement(p.a,{type:"primary",className:"d-block d-lg-none mt-3",onClick:e},c.a.createElement(m.a,{defaultMessage:"Show Chats",id:"chat.show_chats"})))}}])&&b(a.prototype,n),r&&b(a,r),t}(o.Component),w=a("tE8B"),S=a.n(w),O=a("MM9K"),_=a.n(O),j=a("iJl9"),k=a.n(j),M=a("Pbn2"),C=a.n(M),P=a("RWbP"),T=a.n(P),N=a("qPyV"),x=a.n(N),D=a("UfWW"),U=a.n(D),A=a("E+oP"),F=a.n(A),I=a("hqwM"),R=a.n(I),B=a("7++0"),L=a("zSVi"),W=a("amnm"),V=a("J2m7"),z=a.n(V),K=a("pWf2"),q=a.n(K),H=a("DRDh"),G=a("Falu"),Q=a("fVSG"),Y=a("wUfQ");function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e){return(Z="function"==typeof Symbol&&"symbol"===J(Symbol.iterator)?function(e){return J(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":J(e)})(e)}function X(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ae(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ne=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=$(t).call(this,e),a=!r||"object"!==Z(r)&&"function"!=typeof r?ee(n):r,ae(ee(a),"chatParticipationChangedListener",(function(e){F()(e)||a.props.auth.user.id===e.user_id&&a.setState({participation:e})})),ae(ee(a),"chatUpdatedListener",(function(e){var t=a.api,n=t.axios,r=t.route;if(!F()(e.chat)){a.fetchParticipation();var o=r("chats.get",{chat:e.chat.id});n.post(o.url()).then((function(e){return Object(Q.d)(e,(function(e){a.updateChat(e)}))})).catch((function(e){return Object(Q.a)(e)}))}})),ae(ee(a),"getUserAvatar",(function(){var e=a.getHighlightedParticipant();return F()(e)?c.a.createElement(q.a,{icon:"message",size:50}):c.a.createElement(W.a,{user:e.user,size:50})})),ae(ee(a),"getMessageDetail",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;switch(e.type){case"activity":return a.getActivityDetail(e.activity,t);case"text":return a.getTextDetail(e.text,t);case"attachment":return a.getAttachmentDetail(e.attachment,t);default:return null}})),ae(ee(a),"getTextDetail",(function(e,t){return F()(e)?c.a.createElement("span",null,c.a.createElement("i",{className:"la la-ban mr-1"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Message Deleted",id:"chats.message_deleted"}))):c.a.createElement("span",null,Object(i.f)(e.body,t))})),ae(ee(a),"getAttachmentDetail",(function(e,t){return F()(e)?c.a.createElement("span",null,c.a.createElement("i",{className:"la la-ban mr-1"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Message Deleted",id:"chats.message_deleted"}))):c.a.createElement("span",null,c.a.createElement("i",{className:"la la-paperclip mr-1"}),c.a.createElement("span",null,Object(i.f)(e.name,t)))})),ae(ee(a),"getActivityDetail",(function(e,t){return e&&c.a.createElement("span",null,Object(i.f)(e.body,t))})),ae(ee(a),"handleClick",(function(){var e=a.props,t=e.onOpen,n=e.chat;if("function"==typeof t)return t(n)})),a.broadcast=new H.a,a.api=new G.a,a.state={participation:{}},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.bindBroadcastEvents(),this.fetchParticipation()}},{key:"bindBroadcastEvents",value:function(){this.resetBroadcastChannel(),this.broadcast.listen("ChatParticipationChanged",this.chatParticipationChangedListener),this.broadcast.listen("ChatUpdated",this.chatUpdatedListener)}},{key:"updateChat",value:function(e){var t=this.props.onChatUpdated;if("function"==typeof t)return t(e)}},{key:"resetBroadcastChannel",value:function(){var e=this.props.chat;F()(e)?this.broadcast.unbind():this.broadcast.setChannel("App.Chat."+e.id)}},{key:"fetchParticipation",value:function(){var e=this,t=this.api,a=t.axios,n=(0,t.route)("chats.participation",{chat:this.props.chat.id});a.post(n.url()).then((function(t){return Object(Q.d)(t,(function(t){e.setState({participation:t})}))})).catch((function(e){return Object(Q.a)(e)}))}},{key:"componentDidUpdate",value:function(e,t,a){var n=e.chat,r=this.props.chat;n.id!==r.id&&(console.info("ChatCell Updated"),this.resetBroadcastChannel())}},{key:"componentWillUnmount",value:function(){this.broadcast.unbind(),this.api.cancel()}},{key:"getTitle",value:function(){var e=this.props.chat,t=this.getHighlightedParticipant();if(F()(t))return c.a.createElement(m.a,{defaultMessage:"Conversation",id:"chats.conversation"});var a=t.user.name;return e.participants.length>1&&(a=c.a.createElement(m.a,{id:"chats.cell_title",defaultMessage:"{user} and {total} other(s)",values:{total:e.participants.length-1,user:t.user.name}})),c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium"},a))}},{key:"getUser",value:function(e){var t=this.props,a=t.chat,n=t.auth,r=a.participants;if(n.user.id===e)return n.user;var o=z()(r,(function(t){return!F()(t.user)&&t.user.id===e}));return F()(o)?o:o.user}},{key:"getLastMessage",value:function(){var e=this.props,t=e.chat,a=e.auth,n=t.latest_message,r=t.participants;if(F()(n))return null;var o=n.user;return F()(o)?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium mr-1"},c.a.createElement(m.a,{defaultMessage:"Unknown User",id:"common.unknown_user"}),":"),this.getMessageDetail(n,20)):o.id===a.user.id?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium mr-1"},c.a.createElement(m.a,{defaultMessage:"Me",id:"common.me"}),":"),this.getMessageDetail(n,23)):r.length>1?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium mr-1"},o.name,":"),this.getMessageDetail(n,20)):this.getMessageDetail(n,25)}},{key:"getHighlightedParticipant",value:function(){if(F()(this.highlightedParticpant)){var e=this.props,t=e.chat,a=e.auth,n=t.participants;this.highlightedParticpant=z()(n,(function(e){return!F()(e.user)&&e.user.id!==a.user.id}))}return this.highlightedParticpant}},{key:"getTime",value:function(){var e=this.props.chat.latest_message;return F()(e)?null:Object(i.g)(e.created_at)}},{key:"getUnreadCount",value:function(){var e=this.state.participation;if(this.props.active||F()(e))return null;var t=e.unread_messages_count;return!t||t<=0?null:Object(Y.a)(t)}},{key:"render",value:function(){var e=this.getUnreadCount(),t=this.props.active,a="cp-chat-user-item ".concat(t&&"active");return c.a.createElement("div",{className:a,onClick:this.handleClick},c.a.createElement("div",{className:"cp-chat-user-row"},c.a.createElement("div",{className:"cp-chat-avatar"},this.getUserAvatar()),c.a.createElement("div",{className:"cp-chat-info"},c.a.createElement("span",{className:"cp-chat-name h4"},this.getTitle()),c.a.createElement("div",{className:"cp-chat-desc"},this.getLastMessage()),c.a.createElement("div",{className:"cp-chat-time"},this.getTime())),c.a.createElement("div",{className:"cp-chat-date"},e&&c.a.createElement("div",{className:"badge"},e))))}}])&&X(a.prototype,n),r&&X(a,r),t}(o.Component),re=a("RotF"),oe=a.n(re),ce=a("mP/V"),ie=a("v1ta"),se=a("pvl8"),le=a("VWBV");function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e){return(fe="function"==typeof Symbol&&"symbol"===ue(Symbol.iterator)?function(e){return ue(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ue(e)})(e)}function pe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pe(a,!0).forEach((function(t){ve(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function de(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function he(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ee=R.a.Item,we=Object(B.a)({searchUsers:{id:"chats.input_filter_by_contact_name_placeholder",defaultMessage:"Filter by contact name..."}}),Se=function(e){function t(e){var a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=be(t).call(this,e),a=!r||"object"!==fe(r)&&"function"!=typeof r?ye(n):r,ve(ye(a),"chatParticipantCreatedListener",(function(e){var t=a.api,n=t.axios,r=t.route;if(!F()(e.participant)){var o=r("chats.get",{chat:e.participant.chat_id});n.post(o.url()).then((function(e){return Object(Q.d)(e,(function(e){a.setState((function(t){var n=t.data.concat(e);return{data:a.sortChats(n)}}))}))})).catch((function(e){return Object(Q.a)(e)}))}})),ve(ye(a),"onChatUpdated",(function(e){var t=a.state.data,n=U()(t,(function(t){return t.id===e.id})),r=de(t);n<0?r=r.concat(e):r[n]=e,r=a.sortChats(r),a.setState({data:r})})),ve(ye(a),"sortChats",(function(e){return Array.isArray(e)?(e=e.sort((function(e,t){return Object(i.d)(t.updated_at,e.updated_at)})),x()(e,"id")):e})),ve(ye(a),"fetchChats",(function(){var e=a.state,t=e.params,n=e.filters,r=me(me({},t),{},{current:1});a.pagination.fetchData(r,n,(function(e){a.setState((function(){return{params:me(me({},r),{},{total:e.meta.total}),data:e.data,loading:!1,hasMore:Boolean(e.links.next)}}))}),(function(){a.setState({loading:!1})})),a.setState({loading:!0})})),ve(ye(a),"onChangeUserSearch",(function(e){var t=e.target.value;clearTimeout(a.searching);var n=a.state.filters;a.canSearchUser()&&(a.setState({filters:me(me({},n),{},{user:t})}),a.searching=setTimeout(a.fetchChats,2e3))})),ve(ye(a),"onSearchKeyUp",(function(e){"Enter"===e.key&&(clearTimeout(a.searching),a.fetchChats())})),ve(ye(a),"onLoadMore",(function(e){if(a.canLoadMore()){var t=a.state,n=t.params,r=t.filters,o=me(me({},n),{},{current:n.current+1});a.pagination.fetchData(o,r,(function(e){a.setState((function(t){var n=t.data.concat(e.data);return{data:a.sortChats(n),params:me(me({},o),{},{total:e.meta.total}),loadingMore:!1,hasMore:Boolean(e.links.next)}}))}),(function(){a.setState({loadingMore:!1})})),a.setState({loadingMore:!0})}})),ve(ye(a),"handleChatOpen",(function(e){var t=a.props.history,n=Object(l.g)(le.a["chat.view"].path,{token:e.id});if(!F()(t))return t.replace(n)})),ve(ye(a),"setScrollWrapper",(function(e){if(e!==a.scrollWrapper&&null!==e){var t=new se.a(e);a.scrollParent=t.getScrollElement(),a.scrollWrapper=e}})),a.broadcast=new H.a,a.api=new G.a,a.state={data:[],hasMore:!1,params:{total:0,pageSize:20,current:1},filters:{user:""},loadingMore:!1,loading:!1};var o=a.api.route("chats.table").url();return a.pagination=new ce.a(a.api,o),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.bindBroadcastEvents(),this.fetchChats()}},{key:"bindBroadcastEvents",value:function(){this.resetBroadcastChannel(),this.broadcast.listen("ChatParticipantCreated",this.chatParticipantCreatedListener)}},{key:"resetBroadcastChannel",value:function(){var e=this.props.auth;e.check()?this.broadcast.setChannel("Auth.User."+e.user.id):this.broadcast.unbind()}},{key:"componentDidUpdate",value:function(e,t,a){var n=e.auth.user,r=this.props.auth.user;n.id!==r.id&&(console.info("Menu Updated"),this.resetBroadcastChannel())}},{key:"componentWillUnmount",value:function(){this.broadcast.unbind(),this.api.cancel()}},{key:"canSearchUser",value:function(){var e=this.state,t=e.loading,a=e.loadingMore;return!(t||a)}},{key:"canLoadMore",value:function(){var e=this.state,t=e.hasMore,a=e.loadingMore,n=e.loading;return t&&!a&&!n}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.loadingMore,r=t.hasMore,o=t.filters,i=t.data,s=this.props,l=s.intl,u=s.auth,f=s.activeChat,p=u.user.marketplace_stats.total_active_trades;return c.a.createElement("div",{className:"cp-chat-sidenav-main"},c.a.createElement("div",{className:"cp-chat-sidenav-header"},c.a.createElement("div",{className:"cp-chat-user-hd"},c.a.createElement("div",{className:"cp-chat-avatar mr-3"},c.a.createElement(W.a,{user:u.user,showPresence:!1,size:50})),c.a.createElement("div",{className:"cp-module-user-info flex-column justify-content-center"},c.a.createElement("div",{className:"cp-module-title"},c.a.createElement("h5",{className:"mb-0"},c.a.createElement(m.a,{defaultMessage:"Conversations",id:"chats.conversations"}))),c.a.createElement("div",{className:"cp-module-user-detail"},c.a.createElement("div",{className:"cp-text-grey d-flex my-1 align-items-center"},p>0&&c.a.createElement(T.a,{count:p,style:{backgroundColor:"#2db7f5"},className:"mb-0 mr-2"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Active Trades",id:"common.active_trades"})))))),c.a.createElement("div",{className:"cp-chat-search-wrapper"},c.a.createElement(k.a,{suffix:c.a.createElement(C.a,{type:"search"}),placeholder:l.formatMessage(we.searchUsers),size:"large",onKeyUp:this.onSearchKeyUp,disabled:!this.canSearchUser(),onChange:this.onChangeUserSearch,value:o.user}))),c.a.createElement("div",{className:"cp-chat-sidenav-content"},c.a.createElement(_.a,{spinning:a},c.a.createElement("div",{ref:this.setScrollWrapper,className:"cp-chat-sidenav-scroll","data-simplebar":!0},c.a.createElement(oe.a,{useWindow:!1,getScrollParent:function(){return e.scrollParent},loadMore:this.onLoadMore,pageStart:1,hasMore:!n&&r,initialLoad:!1},c.a.createElement("div",{className:"cp-chat-user"},c.a.createElement(R.a,{dataSource:i,rowKey:function(e){return e.id},renderItem:function(t){return c.a.createElement(Ee,{className:"p-0"},c.a.createElement(ne,{onChatUpdated:e.onChatUpdated,active:f&&f.token===t.id,auth:u,chat:t,onOpen:e.handleChatOpen}))}})),n&&c.a.createElement(ie.a,null))))))}}])&&he(a.prototype,n),r&&he(a,r),t}(o.Component),Oe=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),L.c,l.i)(Se),_e=a("9xET"),je=a.n(_e),ke=a("B8+X"),Me=a.n(ke),Ce=a("ZPTe"),Pe=a.n(Ce),Te=a("3WF5"),Ne=a.n(Te),xe=a("mwIZ"),De=a.n(xe),Ue=a("k4Da"),Ae=a.n(Ue),Fe=a("QpBz"),Ie=a.n(Fe),Re=a("OFL0"),Be=a.n(Re),Le=a("hw8t"),We=a.n(Le);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ze(e){return(ze="function"==typeof Symbol&&"symbol"===Ve(Symbol.iterator)?function(e){return Ve(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Ve(e)})(e)}function Ke(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qe(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qe(this,He(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props.onToggleDrawer;return c.a.createElement("div",{className:"d-flex align-items-center w-100"},c.a.createElement("div",{className:"text-center w-100"},c.a.createElement(We.a,{title:c.a.createElement(m.a,{defaultMessage:"Chat could not be found.",id:"chats.chat_not_found_title"}),extra:c.a.createElement(p.a,{type:"primary",className:"d-inline-block d-lg-none mt-3",onClick:e},c.a.createElement(m.a,{defaultMessage:"Show Chats",id:"chat.show_chats"})),subTitle:c.a.createElement(m.a,{defaultMessage:"Please, select a new chat to display!",id:"chats.chat_not_found_sub_title"}),status:"404"})))}}])&&Ke(a.prototype,n),r&&Ke(a,r),t}(o.Component),Ye=a("55Ip");function Je(e){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"===Je(Symbol.iterator)?function(e){return Je(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Je(e)})(e)}function Xe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function at(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var nt=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=this,r=(e=$e(t)).call.apply(e,[this].concat(s)),a=!r||"object"!==Ze(r)&&"function"!=typeof r?et(n):r,at(et(a),"getUserAvatar",(function(){var e=a.props.message.user;return c.a.createElement(Ye.a,{to:"/profile/".concat(e.name)},c.a.createElement(W.a,{className:"align-self-end",user:e,size:40}))})),at(et(a),"getTextDetail",(function(){var e=a.props.message;return F()(e.text)?c.a.createElement("span",null,c.a.createElement("i",{className:"la la-ban mr-1"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Message Deleted",id:"chats.message_deleted"}))):c.a.createElement("span",null,e.text.body)})),at(et(a),"getTimestamp",(function(){var e=a.props.message;return e.created_at&&c.a.createElement("small",{className:"text-muted"},Object(i.g)(e.created_at))})),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e="right"===this.props.mode?"cp-chat-item flex-row-reverse":"cp-chat-item";return c.a.createElement("div",{className:e},this.getUserAvatar(),c.a.createElement("div",{className:"cp-bubble-block"},c.a.createElement("div",{className:"cp-bubble d-inline-block"},c.a.createElement("div",{className:"cp-message mb-2"},this.getTextDetail()),c.a.createElement("div",{className:"cp-time text-right"},this.getTimestamp()))))}}])&&Xe(a.prototype,n),r&&Xe(a,r),t}(o.Component),rt=a("UIqZ"),ot=a.n(rt);function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e){return(it="function"==typeof Symbol&&"symbol"===ct(Symbol.iterator)?function(e){return ct(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ct(e)})(e)}function st(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lt(e,t){return!t||"object"!==it(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lt(this,ut(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,e),a=t,(n=[{key:"getTimestamp",value:function(){var e=this.props.message;return c.a.createElement("span",{className:"font-weight-semi-bold"},Object(i.g)(e.created_at))}},{key:"getUserName",value:function(){var e=this.props.message;return F()(e.user)?c.a.createElement(m.a,{defaultMessage:"Unknown User",id:"common.unknown_user"}):c.a.createElement("span",{className:"font-weight-medium"},e.user.name,":")}},{key:"render",value:function(){var e=this.props.message.activity;return F()(e)||!e.body?c.a.createElement(R.a.Item,null):c.a.createElement(ot.a,{className:"font-weight-normal",dashed:!0},c.a.createElement("small",null,c.a.createElement(m.a,{id:"chat.activity_body",defaultMessage:"{user} {body} {time}",values:{time:this.getTimestamp(),body:e.body,user:this.getUserName()}})))}}])&&st(a.prototype,n),r&&st(a,r),t}(o.Component);function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e){return(dt="function"==typeof Symbol&&"symbol"===mt(Symbol.iterator)?function(e){return mt(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":mt(e)})(e)}function ht(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bt(e){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Et=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=this,r=(e=bt(t)).call.apply(e,[this].concat(i)),a=!r||"object"!==dt(r)&&"function"!=typeof r?yt(n):r,vt(yt(a),"getUserAvatar",(function(){var e=a.props.message.user;return c.a.createElement(Ye.a,{to:"/profile/".concat(e.name)},c.a.createElement(W.a,{className:"align-self-end",user:e,size:40}))})),vt(yt(a),"isImageType",(function(e){return"image/jpeg"===e||"image/png"===e})),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(t,e),a=t,(n=[{key:"isImage",value:function(e){switch(e){case"image/gif":case"image/jpeg":case"image/png":return!0;default:return!1}}},{key:"getAttachmentDetail",value:function(){var e=this.props,t=e.message,a=e.openCarousel,n=t.attachment;if(F()(n))return c.a.createElement("div",{className:"cp-attachment d-flex"},c.a.createElement("i",{className:"la la-ban cp-fs-lg mr-2"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Attachment Deleted",id:"chats.attachment_deleted"})));var r=n.url;return c.a.createElement(c.a.Fragment,null,this.isImage(n.mime_type)&&c.a.createElement("div",{className:"cp-thumbnail",onClick:function(){return a(t.id)}},c.a.createElement("img",{src:r,alt:n.name})),c.a.createElement("div",{className:"cp-attachment d-flex"},c.a.createElement("span",{className:"mr-2"},c.a.createElement("i",{className:"la la-paperclip cp-fs-lg"})),c.a.createElement("span",{className:"mr-2 fs-sm"},Object(i.f)(n.name,20)),c.a.createElement(p.a,{className:"ml-0 mb-0",type:"dashed",shape:"circle",href:r,icon:"download"})))}},{key:"getTimestamp",value:function(){var e=this.props.message;return c.a.createElement("small",{className:"text-muted"},Object(i.g)(e.created_at))}},{key:"render",value:function(){var e="right"===this.props.mode?"cp-chat-item flex-row-reverse":"cp-chat-item";return c.a.createElement("div",{className:e},this.getUserAvatar(),c.a.createElement("div",{className:"cp-bubble-block"},c.a.createElement("div",{className:"cp-bubble d-inline-block"},c.a.createElement("div",{className:"cp-message mb-2"},this.getAttachmentDetail()),c.a.createElement("div",{className:"cp-time text-right"},this.getTimestamp()))))}}])&&ht(a.prototype,n),r&&ht(a,r),t}(o.Component),wt=a("aOJk"),St=a.n(wt),Ot=a("EQeY"),_t=a.n(Ot),jt=a("gQMU"),kt=a.n(jt),Mt=a("CC+v"),Ct=a.n(Mt),Pt=a("lB7Y"),Tt=a.n(Pt),Nt=a("N9UN"),xt=a.n(Nt);function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e){return(Ut="function"==typeof Symbol&&"symbol"===Dt(Symbol.iterator)?function(e){return Dt(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Dt(e)})(e)}function At(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ft(e,t){return!t||"object"!==Ut(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ft(this,It(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.styleName,a=e.name,n=e.price;return c.a.createElement(xt.a,{className:"".concat(t," cp-card-price mb-0")},c.a.createElement("h6",{className:"text-muted"},a),c.a.createElement("h4",{className:"font-weight-medium"},n))}}])&&At(a.prototype,n),r&&At(a,r),t}(o.Component),Lt=a("wd/R"),Wt=a.n(Lt),Vt=a("ctCr"),zt=a("qu0K"),Kt=a.n(zt),qt=a("4ztd");function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"===Ht(Symbol.iterator)?function(e){return Ht(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Ht(e)})(e)}function Qt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yt(e){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zt(e,t){return(Zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $t=Object(B.a)({twoFactorCode:{id:"marketplace.input_two_factor_code_placeholder",defaultMessage:"Enter your Two Factor code."},password:{id:"marketplace.input_password_placeholder",defaultMessage:"Enter your Password."}}),ea=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,c=new Array(o),i=0;i<o;i++)c[i]=arguments[i];return n=this,r=(e=Yt(t)).call.apply(e,[this].concat(c)),a=!r||"object"!==Gt(r)&&"function"!=typeof r?Jt(n):r,Xt(Jt(a),"cancel",(function(){var e=a.props.onCancel;if("function"==typeof e)return e()})),Xt(Jt(a),"submit",(function(){var e=a.props,t=e.form,n=e.onSubmit;t.validateFields((function(e,t){if(F()(e)&&"function"==typeof n)return n(t.code)}))})),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.withTwoFactor,a=e.intl,n=this.props.form.getFieldDecorator;return c.a.createElement("div",{className:"p-2 text-left"},c.a.createElement(Kt.a,null,t?c.a.createElement(Kt.a.Item,{labelAlign:"left",label:c.a.createElement(m.a,{defaultMessage:"Token",id:"marketplace.token"})},n("code",{rules:[{required:!0}]})(c.a.createElement(k.a,{placeholder:a.formatMessage($t.twoFactorCode)}))):c.a.createElement(Kt.a.Item,{labelAlign:"left",label:c.a.createElement(m.a,{defaultMessage:"Password",id:"marketplace.password"})},n("code",{rules:[{required:!0}]})(c.a.createElement(k.a.Password,{placeholder:a.formatMessage($t.password)}))),c.a.createElement(Kt.a.Item,{className:"mt-2"},c.a.createElement(p.a,{type:"primary",block:!0,onClick:this.submit,className:"mb-0"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Approve Trade",id:"marketplace.approve_trade"}))),c.a.createElement(p.a,{type:"dashed",block:!0,onClick:this.cancel},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Cancel",id:"marketplace.cancel"}))))))}}])&&Qt(a.prototype,n),r&&Qt(a,r),t}(o.Component),ta=Object(i.c)(Object(qt.a)())(ea);function aa(e){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function na(e){return(na="function"==typeof Symbol&&"symbol"===aa(Symbol.iterator)?function(e){return aa(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":aa(e)})(e)}function ra(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oa(e){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ca(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ia(e,t){return(ia=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var la=Tt.a.Countdown,ua=Object(B.a)({approved:{id:"chats.marketplace_approved_successful",defaultMessage:"Trade has been approved."},disputed:{id:"chats.marketplace_disputed_successful",defaultMessage:"A moderator will be in touch soon."},cancelled:{id:"chats.marketplace_cancelled_successful",defaultMessage:"Trade has been cancelled."},confirmed:{id:"chats.marketplace_confirmed_successful",defaultMessage:"Trade has been marked as paid."}}),fa=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=oa(t).call(this,e),a=!r||"object"!==na(r)&&"function"!=typeof r?ca(n):r,sa(ca(a),"onFinishCountDown",(function(){a.update()})),sa(ca(a),"showInstructions",(function(e){Ct.a.info({content:c.a.createElement("p",{style:{whiteSpace:"pre-line"}},e.instructions)})})),sa(ca(a),"showTerms",(function(e){Ct.a.info({content:c.a.createElement("p",{style:{whiteSpace:"pre-line"}},e.terms)})})),sa(ca(a),"update",(function(){var e=a.props.onUpdate;if("function"==typeof e)return e()})),sa(ca(a),"canApproveTrade",(function(e){var t=a.props.auth;return!!e.confirmed_at&&(a.isOnGoing(e)&&(t.user.id===e.seller.id||a.userCanManageTrade(e)))})),sa(ca(a),"approve",(function(e,t){var n=a.api,r=n.axios,o=n.route,c=a.props.intl,i=o("chats.marketplace.approve",{trade:e.id});a.setState({loading:!0}),r.post(i.url(),{code:t}).then((function(e){return Object(Q.d)(e,(function(){a.setState({loading:!1}),a.update(),a.toggleVerificationForm()}),c.formatMessage(ua.approved))})).catch((function(e){return Object(Q.a)(e,(function(){a.setState({loading:!1})}))}))})),sa(ca(a),"isOnGoing",(function(e){return!F()(e)&&("active"===e.status||"dispute"===e.status)})),sa(ca(a),"canConfirmTrade",(function(e){var t=a.props.auth,n=Wt.a.utc(e.cancels_at);return!e.confirmed_at&&(!Wt()().isAfter(n.local())&&("active"===e.status&&t.user.id===e.buyer_id))})),sa(ca(a),"confirm",(function(e){var t=a.api,n=t.axios,r=t.route,o=a.props.intl,c=r("chats.marketplace.confirm",{trade:e.id});a.setState({loading:!0}),n.post(c.url()).then((function(e){return Object(Q.d)(e,(function(){a.setState({loading:!1}),a.update()}),o.formatMessage(ua.confirmed))})).catch((function(e){return Object(Q.a)(e,(function(){a.setState({loading:!1})}))}))})),sa(ca(a),"canCancelTrade",(function(e){var t=a.props.auth;return a.isOnGoing(e)&&(a.userCanManageTrade(e)||t.user.id===e.buyer_id)})),sa(ca(a),"cancel",(function(e){var t=a.api,n=t.axios,r=t.route,o=a.props.intl,c=r("chats.marketplace.cancel",{trade:e.id});a.setState({loading:!0}),n.post(c.url()).then((function(e){return Object(Q.d)(e,(function(e){a.setState({loading:!1}),a.update()}),o.formatMessage(ua.cancelled))})).catch((function(e){return Object(Q.a)(e,(function(){a.setState({loading:!1})}))}))})),sa(ca(a),"canDisputeTrade",(function(e){if(!e.confirmed_at)return!1;if("active"!==e.status)return!1;var t=Wt.a.utc(e.confirmed_at),n=Wt.a.utc(e.created_at),r=Wt.a.utc(e.cancels_at).diff(n);return Wt()().diff(t.local())>r&&a.userIsPartOfTrade(e)})),sa(ca(a),"dispute",(function(e){var t=a.api,n=t.axios,r=t.route,o=a.props.intl,c=r("chats.marketplace.dispute",{trade:e.id});a.setState({loading:!0}),n.post(c.url()).then((function(e){return Object(Q.d)(e,(function(e){a.setState({loading:!1}),a.update()}),o.formatMessage(ua.disputed))})).catch((function(e){return Object(Q.a)(e,(function(){a.setState({loading:!1})}))}))})),sa(ca(a),"getStatusColor",(function(e){switch(e){case"successful":return"#52c41a";case"active":return"#2db7f5";case"dispute":return"#faad14";case"cancelled":return"#f5222d";default:return null}})),sa(ca(a),"toggleVerificationForm",(function(){a.setState((function(e){return{showVerificationForm:!e.showVerificationForm}}))})),a.api=new G.a,a.state={showVerificationForm:!1,loading:!1},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ia(e,t)}(t,e),a=t,(n=[{key:"userCanManageTrade",value:function(e){return this.props.auth.can("manage_marketplace")&&!this.userIsPartOfTrade(e)}},{key:"userIsPartOfTrade",value:function(e){var t=this.props.auth;return t.user.id===e.seller_id||t.user.id===e.buyer_id}},{key:"componentWillUnmount",value:function(){this.api.cancel()}},{key:"render",value:function(){var e=this,t=this.props,a=t.trade,n=t.auth;if(F()(a)||!this.isOnGoing(a))return null;var r=this.state,o=r.loading,i=r.showVerificationForm,s=n.twoFactorSetting();return c.a.createElement(_.a,{spinning:o},c.a.createElement("div",{className:"cp-trade pt-3",key:a.id},c.a.createElement("h3",{className:"text-center"},c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"Trade Status",id:"chats.trade_status"})),c.a.createElement("span",null,c.a.createElement(_t.a,{color:this.getStatusColor(a.status)},kt()(a.status)))),c.a.createElement(ot.a,null),c.a.createElement("div",{className:"px-1"},c.a.createElement(je.a,{gutter:8},c.a.createElement(Pe.a,{span:12},c.a.createElement(Bt,{price:a.formatted_amount_price,styleName:"mb-3",name:c.a.createElement(m.a,{defaultMessage:"Amount",id:"common.amount"})})),c.a.createElement(Pe.a,{span:12},c.a.createElement(Bt,{price:a.formatted_rate,styleName:"mb-3",name:c.a.createElement(m.a,{defaultMessage:"Rate",id:"common.rate"})}))),c.a.createElement(je.a,{gutter:8},c.a.createElement(Pe.a,{span:12},c.a.createElement(Bt,{price:a.coin_name,name:c.a.createElement(m.a,{defaultMessage:"Coin",id:"common.coin"})})),c.a.createElement(Pe.a,{span:12},c.a.createElement(Bt,{price:a.formatted_fee_price,name:c.a.createElement(m.a,{defaultMessage:"Fee",id:"common.fee"})})))),!a.confirmed_at&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ot.a,null),c.a.createElement("div",{className:"text-center"},c.a.createElement(la,{onFinish:this.onFinishCountDown,value:Wt.a.utc(a.cancels_at).local(),title:c.a.createElement(m.a,{defaultMessage:"Payment Deadline",id:"common.payment_deadline"})})),c.a.createElement(ot.a,null)),c.a.createElement("div",{className:"my-3 text-center w-100"},this.canApproveTrade(a)&&c.a.createElement("div",null,i?c.a.createElement(ta,{onSubmit:function(t){return e.approve(a,t)},onCancel:this.toggleVerificationForm,withTwoFactor:s.marketplace()}):c.a.createElement(p.a,{type:"default",shape:"round",onClick:this.toggleVerificationForm,className:"mx-0 mb-2 cp-btn-success",icon:"check-circle",size:"small"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Release Coin",id:"trade.release_coin"})))),this.canConfirmTrade(a)&&c.a.createElement("div",null,c.a.createElement(Vt.a,{onConfirm:function(){return e.confirm(a)},title:c.a.createElement(m.a,{defaultMessage:"Are you sure you want to {action}?",id:"trade.mark_trade_as_paid_confirmation",values:{action:c.a.createElement("b",null,c.a.createElement(m.a,{defaultMessage:"Mark Trade as Paid",id:"trade.mark_trade_as_paid"}))}})},c.a.createElement(p.a,{type:"default",icon:"check",size:"small",className:"mx-0 mb-2",shape:"round"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Mark Trade as Paid",id:"trade.mark_trade_as_paid"}))))),this.canCancelTrade(a)&&c.a.createElement("div",null,c.a.createElement(Vt.a,{onConfirm:function(){return e.cancel(a)},title:c.a.createElement(m.a,{defaultMessage:"Are you sure you want to {action}?",id:"offer.cancel_trade_confirmation",values:{action:c.a.createElement("b",null,c.a.createElement(m.a,{defaultMessage:"Cancel Trade",id:"trade.cancel_trade"}))}})},c.a.createElement(p.a,{type:"default",shape:"round",className:"cp-btn-danger mx-0 mb-2",icon:"close-circle",size:"small"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Cancel Trade",id:"trade.cancel_trade"}))))),this.canDisputeTrade(a)&&c.a.createElement("div",null,c.a.createElement(Vt.a,{onConfirm:function(){return e.dispute(a)},title:c.a.createElement(m.a,{defaultMessage:"Are you sure you want to {action}?",id:"offer.raise_dispute_confirmation",values:{action:c.a.createElement("b",null,c.a.createElement(m.a,{defaultMessage:"Raise Dispute",id:"trade.raise_dispute"}))}})},c.a.createElement(p.a,{type:"default",shape:"round",className:"cp-btn-warning mx-0 mb-2",icon:"flag",size:"small"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Raise Dispute",id:"trade.raise_dispute"})))))),c.a.createElement(ot.a,null),c.a.createElement("div",{className:"px-2 mb-3 text-center"},c.a.createElement("h5",{className:"mb-2"},c.a.createElement("a",{className:"mr-2",onClick:function(){return e.showTerms(a)}},c.a.createElement(m.a,{defaultMessage:"Terms",id:"common.terms"})),c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"and",id:"common.and"})),c.a.createElement("a",{className:"mr-2",onClick:function(){return e.showInstructions(a)}},c.a.createElement(m.a,{defaultMessage:"Instructions",id:"common.instruction"}))),c.a.createElement("h5",{className:"mb-2"},c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"{buyer} to pay {offerAmount} to {seller}",values:{seller:c.a.createElement("b",null,a.seller.name),offerAmount:c.a.createElement("b",null,a.formatted_offer_amount),buyer:c.a.createElement("b",null,a.buyer.name)},id:"chats.trade_payment_instruction"}))),c.a.createElement("h5",null,c.a.createElement("span",{className:"mr-2"},a.payment_method_name),a.payment_method_description&&c.a.createElement(St.a,{overlayStyle:{maxWidth:250},content:a.payment_method_description,title:c.a.createElement(m.a,{id:"common.payment_method_description",defaultMessage:"Description"}),trigger:"click"},c.a.createElement(C.a,{type:"question-circle",theme:"filled"})))),c.a.createElement(ot.a,null)))}}])&&ra(a.prototype,n),r&&ra(a,r),t}(o.Component),pa=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),L.c)(fa),ma=a("IztG"),da=a.n(ma),ha=a("fTA7"),ba=a.n(ha);function ya(e){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ga(e){return(ga="function"==typeof Symbol&&"symbol"===ya(Symbol.iterator)?function(e){return ya(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ya(e)})(e)}function va(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sa(e,t){return(Sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oa=k.a.TextArea,_a=Object(B.a)({successful:{id:"admin.review_submitted_successful",defaultMessage:"You review has been submitted."},review:{id:"admin.textarea_review_placeholder",defaultMessage:"Write a review..."}}),ja=function(e){function t(e){var a,n,r,o,c,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Ea(t).call(this,e),a=!r||"object"!==ga(r)&&"function"!=typeof r?wa(n):r,o=wa(a),i=function(e){e.preventDefault();var t=a.props,n=t.form,r=t.intl,o=t.trade,c=a.api,i=c.axios,s=(0,c.route)("chats.marketplace.submit-review",{trade:o.id});n.validateFields((function(e,t){F()(e)&&(i.post(s.url(),t).then((function(e){return Object(Q.c)(e,n,(function(){a.setState({loading:!1,submitted:!0})}),r.formatMessage(_a.successful))})).catch((function(e){return Object(Q.b)(e,n,t,(function(){a.setState({loading:!1})}))})),a.setState({loading:!0}))}))},(c="handleSubmit")in o?Object.defineProperty(o,c,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[c]=i,a.api=new G.a,a.state={submitted:!1,loading:!1},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sa(e,t)}(t,e),a=t,(n=[{key:"canSubmitReview",value:function(){var e=this.props,t=e.trade,a=e.auth,n=this.state.submitted;return"successful"===t.status&&(t.buyer_id===a.user.id?t.seller_rateable&&!n:t.seller_id===a.user.id&&t.buyer_rateable&&!n)}},{key:"componentWillUnmount",value:function(){this.api.cancel()}},{key:"render",value:function(){if(!this.canSubmitReview())return null;var e=this.props,t=e.intl,a=e.form.getFieldDecorator,n=this.state.loading;return c.a.createElement("div",{className:"px-3"},c.a.createElement(da.a,{content:c.a.createElement(Kt.a,{onSubmit:this.handleSubmit},c.a.createElement(Kt.a.Item,null,a("comment",{rules:[{type:"string",required:!0,min:3,max:200}]})(c.a.createElement(Oa,{style:{resize:"none"},placeholder:t.formatMessage(_a.review),rows:3}))),c.a.createElement(Kt.a.Item,{className:"d-flex align-items-center"},c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"Rate",id:"common.rate"}),":"),a("rating",{rules:[{type:"number",required:!0,min:1,max:5}]})(c.a.createElement(ba.a,null))),c.a.createElement(Kt.a.Item,null,c.a.createElement(p.a,{htmlType:"submit",loading:n,className:"mb-0",shape:"round",type:"primary"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Submit Review",id:"marketplace.submit_review"})))))}))}}])&&va(a.prototype,n),r&&va(a,r),t}(o.Component),ka=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),Object(qt.a)())(ja),Ma=a("E4Ak");function Ca(e){return(Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"===Ca(Symbol.iterator)?function(e){return Ca(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Ca(e)})(e)}function Ta(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Na(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ta(a,!0).forEach((function(t){Fa(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ta(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function xa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Da(e){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ua(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aa(e,t){return(Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ia=k.a.TextArea,Ra=Object(B.a)({inputMessage:{id:"chats.input_message_placeholder",defaultMessage:"Type a message..."}}),Ba=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Da(t).call(this,e),a=!r||"object"!==Pa(r)&&"function"!=typeof r?Ua(n):r,Fa(Ua(a),"openCarousel",(function(e){var t=U()(a.getImagesData(),(function(t){return t.id===e}));t>=0&&a.setState({carouselVisibility:!0,selectedImage:t})})),Fa(Ua(a),"closeCarousel",(function(){a.setState({carouselVisibility:!1})})),Fa(Ua(a),"marketplaceTradeSavedListener",(function(e){a.fetchMarketplaceTrade()})),Fa(Ua(a),"newChatMessageListener",(function(e){var t=a.props.auth;if(!F()(e.message)){var n=e.message;n.user_id!==t.user.id&&a.updateParticipation(n.chat_id),a.setState((function(e){var t=e.data;return{data:a.sortMessages(t.concat(n))}}),(function(){a.scrollToBottom()}))}})),Fa(Ua(a),"onMarketplaceTradeUpdate",(function(){a.toggleMarketplaceTradeDrawer(),a.fetchMarketplaceTrade()})),Fa(Ua(a),"updateParticipation",(function(e){var t=a.api,n=t.axios,r=t.route;if(e){var o=r("chats.update-participation",{chat:e});n.post(o.url()).then((function(e){return Object(Q.d)(e)})).catch((function(e){return Object(Q.a)(e)}))}})),Fa(Ua(a),"sendText",(function(){var e=a.state,t=e.chat,n=e.text;if(n&&a.canSendMessage()){var r=a.api,o=r.axios,c=(0,r.route)("chats.messages.save-text",{chat:t.id});o.post(c.url(),{body:n}).then((function(e){return Object(Q.d)(e,(function(){a.setState({sendingText:!1})}))})).catch((function(e){return Object(Q.a)(e,(function(){a.setState({sendingText:!1})}))})),a.setState({sendingText:!0,text:""},(function(){a.scrollToBottom()}))}})),Fa(Ua(a),"beforeUpload",(function(e){var t=a.canSendMessage();return a.setState({sendingAttachment:t},(function(){t&&a.scrollToBottom()})),t})),Fa(Ua(a),"handleUploadSuccess",(function(e){a.setState((function(t){var n=t.data;return{sendingAttachment:!1,data:a.sortMessages(n.concat(e))}}),(function(){a.scrollToBottom()}))})),Fa(Ua(a),"handleUploadError",(function(e){Be()(e,"file")&&e.file.forEach((function(e){return Ie.a.error(e)}))})),Fa(Ua(a),"fetchMessages",(function(){var e=a.state,t=e.filters,n=e.chat,r=Na(Na({},e.params),{},{current:1});if(!F()(n)&&n.id){var o=a.api.route("chats.messages.table",{chat:n.id}).url();a.mesagePagination=new ce.a(a.api,o),a.setState({loading:!0,data:[]}),a.mesagePagination.fetchData(r,t,(function(e){var t=Boolean(e.links.next);a.setState((function(){return{data:a.sortMessages(e.data),loading:!1,hasMore:!1,params:Na(Na({},r),{},{total:e.meta.total})}}),(function(){var e=a.scrollParent;void 0!==e&&(e.scrollTop=e.scrollHeight,a.setState({hasMore:t}),console.log("Showing Latest Messages"))}))}),(function(){a.setState({loading:!1})}))}})),Fa(Ua(a),"sortMessages",(function(e){return Array.isArray(e)?(e=e.sort((function(e,t){return Object(i.d)(e.created_at,t.created_at)})),x()(e,"id")):e})),Fa(Ua(a),"onLoadMore",(function(){if(a.canLoadMoreMessages()){var e=a.state,t=e.params,n=e.filters,r=Na(Na({},t),{},{current:t.current+1});a.mesagePagination.fetchData(r,n,(function(e){a.setState((function(t){var n=t.data;return{data:a.sortMessages(n.concat(e.data)),params:Na(Na({},r),{},{total:e.meta.total}),loadingMore:!1,hasMore:Boolean(e.links.next)}}))}),(function(){a.setState({loadingMore:!1})})),a.setState({loadingMore:!0})}})),Fa(Ua(a),"getUserAvatar",(function(){var e=a.getHighlightedParticipant();return F()(e)?c.a.createElement(q.a,{icon:"message",size:40}):c.a.createElement(W.a,{showPresence:!1,user:e.user,size:40})})),Fa(Ua(a),"onChangeText",(function(e){a.setState({text:e.target.value})})),Fa(Ua(a),"handleTextKeyUp",(function(e){"Enter"===e.key&&a.sendText()})),Fa(Ua(a),"toggleMarketplaceTradeDrawer",(function(){a.changeFullscreen(!1),a.setState((function(e){return{marketplaceTradeDrawerState:!e.marketplaceTradeDrawerState}}))})),Fa(Ua(a),"setScrollWrapper",(function(e){if(e!==a.scrollWrapper&&null!==e){var t=new se.a(e);a.scrollParent=t.getScrollElement(),a.scrollWrapper=e}})),Fa(Ua(a),"getStatusColor",(function(e){switch(e){case"successful":return"#52c41a";case"active":return"#2db7f5";case"dispute":return"#faad14";case"cancelled":return"#f5222d";default:return null}})),a.broadcast=new H.a,a.api=new G.a,a.state={chat:{},selectedImage:0,carouselVisibility:!1,loadingChat:!1,data:[],hasMore:!1,params:{total:0,pageSize:40,current:1},marketplaceTrade:{},marketplaceTradeDrawerState:!1,loading:!1,loadingMore:!1,text:"",sendingAttachment:!1,sendingText:!1},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aa(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.fetchChat()}},{key:"resetBroadcastChannel",value:function(){var e=this.state.chat;F()(e)?this.broadcast.unbind():this.broadcast.setChannel("App.Chat."+e.id)}},{key:"getImagesData",value:function(){var e=this,t=this.state.data,a=Ae()(t,(function(t){return"attachment"===De()(t,"type")&&e.isImage(De()(t,"attachment.mime_type"))}));return Ne()(a,(function(e){return{src:De()(e,"attachment.url"),caption:De()(e,"attachment.name"),id:De()(e,"id")}}))}},{key:"isImage",value:function(e){switch(e){case"image/gif":case"image/jpeg":case"image/png":return!0;default:return!1}}},{key:"fetchMarketplaceTrade",value:function(){var e=this,t=this.state.chat;if(!F()(t)&&t.id){var a=this.api,n=a.axios,r=(0,a.route)("chats.latest-marketplace-trade",{chat:t.id});n.post(r.url()).then((function(t){return Object(Q.d)(t,(function(t){e.setState({marketplaceTrade:t},(function(){e.scrollToBottom()}))}))})).catch((function(e){return Object(Q.a)(e)}))}}},{key:"bindBroadcastEvents",value:function(){this.resetBroadcastChannel(),this.broadcast.listen("MarketplaceTradeSaved",this.marketplaceTradeSavedListener),this.broadcast.listen("NewChatMessage",this.newChatMessageListener)}},{key:"scrollToBottom",value:function(){var e=this.scrollParent;e&&(e.scrollTop=e.scrollHeight)}},{key:"canSendMessage",value:function(){return!F()(this.state.chat)&&!this.state.sendingAttachment&&!this.state.sendingText&&this.showMarketplaceTrades()}},{key:"canLoadMoreMessages",value:function(){var e=this.state,t=e.hasMore,a=e.loadingMore,n=e.loading;return t&&!a&&!n}},{key:"componentWillUnmount",value:function(){this.broadcast.unbind(),this.api.cancel()}},{key:"fetchChat",value:function(){var e=this,t=this.api,a=t.axios,n=t.route,r=this.props.activeChat;if(!F()(r)){var o=n("chats.get",{chat:r.token});a.post(o.url()).then((function(t){return Object(Q.d)(t,(function(t){e.setState({loadingChat:!1,chat:t},(function(){e.fetchMessages(),e.fetchMarketplaceTrade(),e.updateParticipation(t.id),e.bindBroadcastEvents()}))}))})).catch((function(t){return Object(Q.a)(t,(function(){e.setState({loadingChat:!1})}))})),this.setState({loadingChat:!0,chat:{}})}}},{key:"getHighlightedParticipant",value:function(){if(F()(this.highlightedParticpant)){var e=this.state.chat,t=this.props.auth,a=e.participants;this.highlightedParticpant=z()(a,(function(e){return!F()(e.user)&&e.user.id!==t.user.id}))}return this.highlightedParticpant}},{key:"getChatTitle",value:function(){var e=this.state.chat,t=this.getHighlightedParticipant(),a=e.participants;if(F()(t))return c.a.createElement(m.a,{defaultMessage:"You and {total} other(s)",id:"chats.default_title",values:{total:a.length}});var n=c.a.createElement(Ye.a,{to:"/profile/".concat(t.user.name)},t.user.name);return a.length>1?c.a.createElement(m.a,{defaultMessage:"{user} and {total} other(s)",id:"chats.view_title",values:{total:a.length-1,user:n}}):n}},{key:"changeFullscreen",value:function(e){var t=this.props.onChangeFullscreen;if("function"==typeof t)return t(e)}},{key:"showMarketplaceTrades",value:function(){var e=this.state.marketplaceTrade;return!F()(e)&&("active"===e.status||"dispute"===e.status)}},{key:"render",value:function(){var e=this,t=this.state,a=t.chat,n=t.data,i=t.text,s=t.marketplaceTrade,l=t.loadingChat,u=t.loading,f=t.loadingMore,p=t.hasMore,m=t.marketplaceTradeDrawerState,d=t.selectedImage,h=t.carouselVisibility,b=this.props,y=b.auth,g=b.intl,v=b.fullscreen,E=b.onToggleFullscreen,w=b.onToggleDrawer;if(F()(a))return l?c.a.createElement(ie.a,null):c.a.createElement(Qe,{onToggleDrawer:w});var S=this.api.route("chats.messages.save-attachment",{chat:a.id});return c.a.createElement(o.Fragment,null,c.a.createElement("div",{className:"cp-chat-main animated fadeIn"},c.a.createElement("div",{className:"cp-chat-main-header"},c.a.createElement("span",{className:"d-block d-lg-none cp-chat-btn"},c.a.createElement("i",{className:"cp-icon-btn la la-comments",onClick:w})),c.a.createElement("div",{className:"cp-chat-main-header-info"},c.a.createElement("div",{className:"cp-chat-avatar mr-2 d-none d-sm-block"},this.getUserAvatar()),c.a.createElement("div",{className:"cp-chat-contact-name"},this.getChatTitle())),this.showMarketplaceTrades()&&c.a.createElement(C.a,{onClick:this.toggleMarketplaceTradeDrawer,type:"dollar-circle",theme:"filled",className:"animated flash infinite slow mr-2 cp-fs-2x cp-icon-btn",style:{color:this.getStatusColor(s.status)}}),v?c.a.createElement("i",{className:"cp-icon-btn la la-compress ml-2 cp-fs-2x",onClick:E}):c.a.createElement("i",{className:"cp-icon-btn la la-expand ml-2 cp-fs-2x",onClick:E})),this.showMarketplaceTrades()&&c.a.createElement(r.a,{visible:m,closable:!1,width:320,onClose:this.toggleMarketplaceTradeDrawer,placement:"right"},c.a.createElement(pa,{onUpdate:this.onMarketplaceTradeUpdate,trade:s})),c.a.createElement(_.a,{spinning:u},c.a.createElement("div",{ref:this.setScrollWrapper,className:"cp-chat-list-scroll","data-simplebar":!0},c.a.createElement(oe.a,{useWindow:!1,loadMore:this.onLoadMore,getScrollParent:function(){return e.scrollParent},isReverse:!0,hasMore:!f&&p,pageStart:1,initialLoad:!1},f&&c.a.createElement(ie.a,null),c.a.createElement(R.a,{dataSource:n,rowKey:function(e){return e.id},renderItem:function(t){var a=t.user_id===y.user.id;switch(t.type){case"text":return c.a.createElement(nt,{mode:a?"right":"left",message:t});case"attachment":return c.a.createElement(Et,{openCarousel:e.openCarousel,mode:a?"right":"left",message:t});case"activity":return c.a.createElement(pt,{message:t});default:return c.a.createElement(R.a.Item,null)}}}),c.a.createElement(ka,{trade:s})))),c.a.createElement("div",{className:"cp-chat-main-footer"},c.a.createElement(je.a,{gutter:8,className:"d-flex align-items-center"},c.a.createElement(Pe.a,{xs:18,sm:20},c.a.createElement(Ia,{onKeyUp:this.handleTextKeyUp,placeholder:g.formatMessage(Ra.inputMessage),rows:2,value:i,disabled:!this.canSendMessage(),autoFocus:!0,style:{maxHeight:"48px",resize:"none"},onChange:this.onChangeText})),c.a.createElement(Pe.a,{xs:6,sm:4},c.a.createElement(je.a,{gutter:4},c.a.createElement(Pe.a,{span:12},c.a.createElement("div",{className:"cp-icon-btn"},c.a.createElement(Me.a,{showUploadList:!1,beforeUpload:this.beforeUpload,action:S.url(),customRequest:G.c,onSuccess:this.handleUploadSuccess,onError:this.handleUploadError,withCredentials:!0},c.a.createElement("i",{className:"la la-paperclip cp-fs-2x"})))),c.a.createElement(Pe.a,{span:12},c.a.createElement("i",{className:"cp-icon-btn la la-paper-plane cp-fs-2x",onClick:this.sendText}))))))),c.a.createElement(Ma.b,null,h&&c.a.createElement(Ma.a,{onClose:this.closeCarousel},c.a.createElement(Ma.c,{currentIndex:d,views:this.getImagesData()}))))}}])&&xa(a.prototype,n),s&&xa(a,s),t}(o.Component),La=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),L.c)(Ba),Wa=a("QprK"),Va=a.n(Wa),za=a("TJpk");function Ka(e){return(Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qa(e){return(qa="function"==typeof Symbol&&"symbol"===Ka(Symbol.iterator)?function(e){return Ka(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Ka(e)})(e)}function Ha(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ga(e){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ya(e,t){return(Ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ja(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Za=Object(B.a)({pageTitle:{id:"meta.title.chat",defaultMessage:"Chat | {name}"}}),Xa=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Ga(t).call(this,e),a=!r||"object"!==qa(r)&&"function"!=typeof r?Qa(n):r,Ja(Qa(a),"onToggleDrawer",(function(){a.setState((function(e){return{drawerState:!e.drawerState,fullscreen:!1}}))})),Ja(Qa(a),"onToggleFullscreen",(function(){a.setState((function(e){return{fullscreen:!e.fullscreen,drawerState:!1}}))})),Ja(Qa(a),"onChangeFullscreen",(function(e){a.setState({fullscreen:e})})),Ja(Qa(a),"getActiveChatParams",(function(){var e=a.props.location,t=Object(l.h)(e.pathname,{exact:!0,path:le.a["chat.view"].path,strict:!1});return t&&t.params})),a.state={drawerState:!1,fullscreen:!1},a}var a,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ya(e,t)}(t,e),a=t,(n=[{key:"getPageTitle",value:function(){return this.props.intl.formatMessage(Za.pageTitle,{name:Va.a.name})}},{key:"render",value:function(){var e=this.getActiveChatParams(),t=this.state,a=t.drawerState,n=t.fullscreen,o=c.a.createElement(Oe,{activeChat:e});return c.a.createElement(c.a.Fragment,null,c.a.createElement(za.Helmet,null,c.a.createElement("title",null,this.getPageTitle())),c.a.createElement(S.a,{onChange:this.onChangeFullscreen,enabled:n},c.a.createElement("div",{className:"cp-app-module cp-chat-module"},c.a.createElement("div",{className:"cp-chat-module-box"},c.a.createElement("div",{className:"d-block d-lg-none"},c.a.createElement(r.a,{visible:a,closable:!1,onClose:this.onToggleDrawer,placement:"left"},o)),c.a.createElement("div",{className:"cp-chat-sidenav d-none d-lg-flex"},o),e?c.a.createElement(La,{key:e.token,onChangeFullscreen:this.onChangeFullscreen,onToggleFullscreen:this.onToggleFullscreen,fullscreen:n,onToggleDrawer:this.onToggleDrawer,activeChat:e}):c.a.createElement(E,{onToggleDrawer:this.onToggleDrawer})))))}}])&&Ha(a.prototype,n),o&&Ha(a,o),t}(o.Component);t.default=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),L.c,l.i)(Xa)},wUfQ:function(e,t,a){"use strict";var n=a("o0o1"),r=a.n(n);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(a,!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s={base:1e3,precision:2,decimalSeparator:".",lowerCase:!1,space:!1,units:["","K","M","B","T","P","E"]},l=function(e){var t=parseFloat(e);if(Number.isNaN(t))throw new Error("Value must be a valid number");if(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)throw new RangeError("Value is either too big or too small");return t},u=r.a.mark((function e(t,a){var n,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a,o=0;case 2:if(!((c=t/n)<1)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,{result:c,count:++o};case 8:n*=a,e.next=2;break;case 11:case"end":return e.stop()}}),e)})),f=function(e,t){if(!Number.isFinite(e))throw new Error("Value must be a finite number");if(!Number.isInteger(t)||t<0)throw new Error("Precision must be a non-negative integer");return Number.isInteger(e)?e:parseFloat(e.toFixed(t))};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=c(c({},s),t);if(!Array.isArray(a.units)||!a.units.length)throw new Error("Units must be an array");var n=l(e),r=n<0?"-":"";n=Math.abs(n);var o=0,i=!0,p=!1,m=void 0;try{for(var d,h=u(n,a.base)[Symbol.iterator]();!(i=(d=h.next()).done);i=!0){var b=d.value;n=b.result,o=b.count}}catch(e){p=!0,m=e}finally{try{i||null==h.return||h.return()}finally{if(p)throw m}}o=o>a.units.length?a.units.length-1:o;var y=a.lowerCase?a.units[o].toLowerCase():a.units[o],g=a.space?" ":"",v=f(n,a.precision),E=v.toString().replace(".",a.decimalSeparator);return"".concat(r).concat(E).concat(g).concat(y)}}};